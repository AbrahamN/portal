
<p>
  <b>Run of Workflow :</b>
  <%= @run.description %> (MyExperiment ID: <%= @run.workflow_id %>)
</p>
<p>
  <b>User:</b>
  <%= User.find(@run.user_id).name %>
</p>
<%= render :partial => 'runstate', :locals => {:run => @run} %>
<%= render :partial => 'runresults', :locals => {:run => @run} %>
<%= render :partial => 'interactionframe'%>
<%= javascript_tag do -%>
var run_probe=""
var interaction_probe=""
var interaction_identifier=""

  $(document).ready(
    function(){
      monitor_run();
    });
  function monitor_run(){
    if(run_probe==""){
      if(interaction_probe!=""){
        window.clearInterval(interaction_probe)
        interaction_probe=""
      } 
      run_probe=window.setInterval("monitoring_run()",1000)
    }else{
        monitor_interaction()
    }
  }

  function monitoring_run(){
    $.ajax({
      url: "<%= 'refresh/'+@run.id.to_s %>",
      type: "GET",
      dataType: "script"
    });
  }
  function monitor_interaction(){
    if(run_probe!=""){
      window.clearInterval(run_probe)
      run_probe=""
      interaction_probe=window.setInterval("monitoring_interaction()",1000)
    }
  }
  function monitoring_interaction(){
    var x = interaction_identifier
    var i_uri = "<%= 'interaction/'+@run.id.to_s %>"+'/'
    if (interaction_identifier != "")
      i_uri = i_uri + x
    $.ajax({
      url: i_uri,
      type: "GET",
      dataType: "script"
    }); 
  }
     
<% end -%>
